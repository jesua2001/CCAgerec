<app-header></app-header>

<ion-content scroll-y="true" class="ion-padding bg-body">
  <div class="d-flex flex-center min-h-100 py-10 px-5">
    <div class="card card-flush w-100 mw-600px shadow-sm">
      <div class="card-body p-10">

        <!-- Título -->
        <h1 class="text-center mb-10 fs-2qx fw-bold text-dark">Consulta de Caja</h1>

        <!-- Input de búsqueda -->
        <div class="mb-5">
          <label class="form-label fw-semibold" style="color: #006d57;">Número de Serie</label>
          <ion-item lines="inset">
            <ion-input
              [(ngModel)]="Nserie"
              name="certificadoInput"
              type="text"
              placeholder="Ej: 12345678"
              autofocus>
            </ion-input>
          </ion-item>
        </div>

        <ion-button expand="block" (click)="buscarCaja()" style="--background: #006d57; --color: white;">
          Buscar Caja
        </ion-button>

        <!-- Mensajes -->
        <ion-text color="danger" *ngIf="error">
          <p class="text-danger text-center mt-5">{{ error }}</p>
        </ion-text>

        <ion-text color="success" *ngIf="mensaje">
          <p class="text-success text-center mt-5">{{ mensaje }}</p>
        </ion-text>

        <!-- Formulario editable -->
        <div *ngIf="caja" class="mt-10">
          <div class="card card-bordered">
            <div class="card-header">
              <div class="card-title fw-bold fs-3">Editar Datos de la Caja</div>
            </div>
            <div class="card-body">
              <form (ngSubmit)="modificarCaja()">
                <ng-container *ngFor="let clave of editableKeys">
                  <div class="mb-4">
                    <label class="form-label fw-semibold" style="color: #006d57;">{{ clave }}</label>
                    <ion-item lines="inset">
                      <ion-input
                        [(ngModel)]="caja[clave]"
                        [name]="'campo_' + clave"
                        [type]="isNumber(caja[clave]) ? 'number' : 'text'"
                        [placeholder]="'Introduce ' + clave.toLowerCase()">
                      </ion-input>
                    </ion-item>
                  </div>
                </ng-container>

                <ion-button expand="block" type="submit" style="--background: #006d57; --color: white;" class="mt-4">
                  Guardar Cambios
                </ion-button>
              </form>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</ion-content>
